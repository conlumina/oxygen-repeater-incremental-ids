{"generator":"Code Snippets v2.14.1","date_created":"2021-04-16 21:23","snippets":[{"name":"Oxygen Repeater Unique IDs","desc":"Give Oxygen repeater child elements a unique ID.\n\nv 1.0 \u00a9 2021, Fabian Kastner\n\nFind this useful? <a href=\"https:\/\/buymeacoffee.com\/fabiankastner\" target=\"_blank\" rel=\"noopener\">Buy me a coffee<\/a>","tags":["Oxygen"],"scope":"global","code":"add_filter( 'do_shortcode_tag', function ( $output, $tag, $attr ) { \n\t\n\tif ( in_array($tag, ['oxy_dynamic_list_3']) ) {\n\t\t$query = '\/\/*[@id]\/*';\n\t\t$output = rename_element_id($query, $output);\n\t}\n\t\n\treturn $output;\n\t\n}, 10, 3);\n\nfunction rename_element_id($query, $output) {\n\t\n\t$dom = new DOMDocument();\n\t$dom->loadHTML(mb_convert_encoding( $output, 'HTML-ENTITIES', 'UTF-8') );\n\t$xpath = new DOMXPath($dom);\n\t$elements = $xpath->query($query);\n\t\n\t$counter = 1;\n\t$attribute = 'id';\n\t$repeater_id = $elements[0]->parentNode->getAttribute($attribute);\n\t\n\tforeach( $elements as $element ) {\n\t\t\n\t\t$parent_id = $element->parentNode->getAttribute($attribute);\n\t\t\n\t\tif ( $element->hasAttribute($attribute) ) {\n\t\t\t$new_id = $element->getAttribute($attribute) . '-' . ( ($parent_id == $repeater_id) ? $counter : ($counter - 1) );\n\t\t\t$element->removeAttribute($attribute);\n\t    \t$element->setAttribute($attribute, $new_id);\n\t\t}\n\t\t\n\t\tif ( $parent_id == $repeater_id ) $counter++;\n\t}\n\t\n\treturn $dom->saveHTML();\n}\n","priority":"10"}]}